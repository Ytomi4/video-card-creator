## Figma プラグイン 要件定義

### 概要

Figma 上で作成した「中央がマスクされた画像」と「その下で位置・スケール調整した動画」を重ねたフレームを、プラグイン UI 上で再現し、その様子を動画として書き出す。

### 機能要件

1. **マスク画像の取得**

   - Figma API を利用し、選択したフレームや画像（PNG 等）を取得する。

2. **動画ファイルの指定・アップロード**

   - プラグイン UI で動画ファイル（WebM, MP4 等）をアップロード・指定できる。

3. **画像＋動画の合成表示**

   - プラグイン UI 上で、マスク画像を上層、動画を下層に重ねて表示。
   - 位置・スケール調整機能（動画の移動・拡大縮小）。

4. **合成状態の録画・書き出し**
   - 録画開始ボタンを押すと、指定した動画の再生と、合成状態（canvas 要素）の録画が同時に開始される。
   - 指定した動画の再生が終了すると同時に、合成状態の録画も自動的に停止する。
   - 録画停止時に WebM 形式で動画ファイルとして保存。
   - （任意）録画を手動で停止できるボタンも設置可能。

### 技術要件

- Figma Plugin API（UI: HTML/CSS/JS, backend: TypeScript）
- MediaRecorder API（canvas 録画）
- Figma REST API（画像取得）
- 必要に応じて html2canvas 等のライブラリ

### 注意事項

- Figma プラグインのサンドボックス制約により、外部ウィンドウや iframe の直接操作は不可。
- 画像・動画の合成はプラグイン UI 内で完結させる。
